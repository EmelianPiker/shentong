{-# LANGUAGE BangPatterns #-}
{-# LANGUAGE OverloadedStrings #-}


{-
Copyright (c) 2015, Mark Tarver

All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:
1. Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in the
   documentation and/or other materials provided with the distribution.
3. The name of Mark Tarver may not be used to endorse or promote products
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY Mark Tarver ''AS IS'' AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL Mark Tarver BE LIABLE FOR ANY
DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-}

module Writer where

import Control.Monad.Except
import Control.Parallel
import Environment
import Primitives
import SourceUtils
import Types
import Utils
import Wrap
import Toplevel
import Core
import Sys
import Sequent
import Yacc
import Reader
import Prolog
import Track
import Load

kl_pr :: Types.KLValue ->
         Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_pr (!kl_V2390) (!kl_V2391) = do (do kl_V2390 `pseq` (kl_V2391 `pseq` kl_shen_prh kl_V2390 kl_V2391 (Types.Atom (Types.N (Types.KI 0))))) `catchError` (\(!kl_E) -> do return kl_V2390)

kl_shen_prh :: Types.KLValue ->
               Types.KLValue ->
               Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_shen_prh (!kl_V2392) (!kl_V2393) (!kl_V2394) = do !appl_0 <- kl_V2392 `pseq` (kl_V2393 `pseq` (kl_V2394 `pseq` kl_shen_write_char_and_inc kl_V2392 kl_V2393 kl_V2394))
                                                     kl_V2392 `pseq` (kl_V2393 `pseq` (appl_0 `pseq` kl_shen_prh kl_V2392 kl_V2393 appl_0))

kl_shen_write_char_and_inc :: Types.KLValue ->
                              Types.KLValue ->
                              Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_shen_write_char_and_inc (!kl_V2395) (!kl_V2396) (!kl_V2397) = do !appl_0 <- kl_V2395 `pseq` (kl_V2397 `pseq` pos kl_V2395 kl_V2397)
                                                                    !appl_1 <- appl_0 `pseq` stringToN appl_0
                                                                    !appl_2 <- appl_1 `pseq` (kl_V2396 `pseq` writeByte appl_1 kl_V2396)
                                                                    !appl_3 <- kl_V2397 `pseq` add kl_V2397 (Types.Atom (Types.N (Types.KI 1)))
                                                                    appl_2 `pseq` (appl_3 `pseq` kl_do appl_2 appl_3)

kl_print :: Types.KLValue ->
            Types.KLContext Types.Env Types.KLValue
kl_print (!kl_V2398) = do let !appl_0 = ApplC (Func "lambda" (Context (\(!kl_String) -> do let !appl_1 = ApplC (Func "lambda" (Context (\(!kl_Print) -> do return kl_V2398)))
                                                                                           !appl_2 <- kl_stoutput
                                                                                           !appl_3 <- kl_String `pseq` (appl_2 `pseq` kl_shen_prhush kl_String appl_2)
                                                                                           appl_3 `pseq` applyWrapper appl_1 [appl_3])))
                          !appl_4 <- kl_V2398 `pseq` kl_shen_insert kl_V2398 (Types.Atom (Types.Str "~S"))
                          appl_4 `pseq` applyWrapper appl_0 [appl_4]

kl_shen_prhush :: Types.KLValue ->
                  Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_shen_prhush (!kl_V2399) (!kl_V2400) = do !kl_if_0 <- value (Types.Atom (Types.UnboundSym "*hush*"))
                                            klIf kl_if_0 (do return kl_V2399) (do kl_V2399 `pseq` (kl_V2400 `pseq` kl_pr kl_V2399 kl_V2400))

kl_shen_mkstr :: Types.KLValue ->
                 Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_shen_mkstr (!kl_V2401) (!kl_V2402) = do !kl_if_0 <- kl_V2401 `pseq` stringP kl_V2401
                                           klIf kl_if_0 (do !appl_1 <- kl_V2401 `pseq` kl_shen_proc_nl kl_V2401
                                                            appl_1 `pseq` (kl_V2402 `pseq` kl_shen_mkstr_l appl_1 kl_V2402)) (do klIf (Atom (B True)) (do let !appl_2 = List []
                                                                                                                                                          !appl_3 <- kl_V2401 `pseq` (appl_2 `pseq` klCons kl_V2401 appl_2)
                                                                                                                                                          !appl_4 <- appl_3 `pseq` klCons (ApplC (wrapNamed "shen.proc-nl" kl_shen_proc_nl)) appl_3
                                                                                                                                                          appl_4 `pseq` (kl_V2402 `pseq` kl_shen_mkstr_r appl_4 kl_V2402)) (do return (List [])))

kl_shen_mkstr_l :: Types.KLValue ->
                   Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_shen_mkstr_l (!kl_V2403) (!kl_V2404) = do let !appl_0 = List []
                                             !kl_if_1 <- appl_0 `pseq` (kl_V2404 `pseq` eq appl_0 kl_V2404)
                                             klIf kl_if_1 (do return kl_V2403) (do !kl_if_2 <- kl_V2404 `pseq` consP kl_V2404
                                                                                   klIf kl_if_2 (do !appl_3 <- kl_V2404 `pseq` hd kl_V2404
                                                                                                    !appl_4 <- appl_3 `pseq` (kl_V2403 `pseq` kl_shen_insert_l appl_3 kl_V2403)
                                                                                                    !appl_5 <- kl_V2404 `pseq` tl kl_V2404
                                                                                                    appl_4 `pseq` (appl_5 `pseq` kl_shen_mkstr_l appl_4 appl_5)) (do klIf (Atom (B True)) (do kl_shen_f_error (ApplC (wrapNamed "shen.mkstr-l" kl_shen_mkstr_l))) (do return (List []))))

kl_shen_insert_l :: Types.KLValue ->
                    Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_shen_insert_l (!kl_V2407) (!kl_V2408) = do !kl_if_0 <- kl_V2408 `pseq` eq (Types.Atom (Types.Str "")) kl_V2408
                                              klIf kl_if_0 (do return (Types.Atom (Types.Str ""))) (do !kl_if_1 <- kl_V2408 `pseq` kl_shen_PlusstringP kl_V2408
                                                                                                       !kl_if_2 <- klIf kl_if_1 (do !appl_3 <- kl_V2408 `pseq` pos kl_V2408 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                                    !kl_if_4 <- appl_3 `pseq` eq (Types.Atom (Types.Str "~")) appl_3
                                                                                                                                    klIf kl_if_4 (do !appl_5 <- kl_V2408 `pseq` tlstr kl_V2408
                                                                                                                                                     !kl_if_6 <- appl_5 `pseq` kl_shen_PlusstringP appl_5
                                                                                                                                                     klIf kl_if_6 (do !appl_7 <- kl_V2408 `pseq` tlstr kl_V2408
                                                                                                                                                                      !appl_8 <- appl_7 `pseq` pos appl_7 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                                                                      appl_8 `pseq` eq (Types.Atom (Types.Str "A")) appl_8) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))
                                                                                                       klIf kl_if_2 (do !appl_9 <- kl_V2408 `pseq` tlstr kl_V2408
                                                                                                                        !appl_10 <- appl_9 `pseq` tlstr appl_9
                                                                                                                        let !appl_11 = List []
                                                                                                                        !appl_12 <- appl_11 `pseq` klCons (Types.Atom (Types.UnboundSym "shen.a")) appl_11
                                                                                                                        !appl_13 <- appl_10 `pseq` (appl_12 `pseq` klCons appl_10 appl_12)
                                                                                                                        !appl_14 <- kl_V2407 `pseq` (appl_13 `pseq` klCons kl_V2407 appl_13)
                                                                                                                        appl_14 `pseq` klCons (ApplC (wrapNamed "shen.app" kl_shen_app)) appl_14) (do !kl_if_15 <- kl_V2408 `pseq` kl_shen_PlusstringP kl_V2408
                                                                                                                                                                                                      !kl_if_16 <- klIf kl_if_15 (do !appl_17 <- kl_V2408 `pseq` pos kl_V2408 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                                                                                                                                     !kl_if_18 <- appl_17 `pseq` eq (Types.Atom (Types.Str "~")) appl_17
                                                                                                                                                                                                                                     klIf kl_if_18 (do !appl_19 <- kl_V2408 `pseq` tlstr kl_V2408
                                                                                                                                                                                                                                                       !kl_if_20 <- appl_19 `pseq` kl_shen_PlusstringP appl_19
                                                                                                                                                                                                                                                       klIf kl_if_20 (do !appl_21 <- kl_V2408 `pseq` tlstr kl_V2408
                                                                                                                                                                                                                                                                         !appl_22 <- appl_21 `pseq` pos appl_21 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                                                                                                                                                                         appl_22 `pseq` eq (Types.Atom (Types.Str "R")) appl_22) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))
                                                                                                                                                                                                      klIf kl_if_16 (do !appl_23 <- kl_V2408 `pseq` tlstr kl_V2408
                                                                                                                                                                                                                        !appl_24 <- appl_23 `pseq` tlstr appl_23
                                                                                                                                                                                                                        let !appl_25 = List []
                                                                                                                                                                                                                        !appl_26 <- appl_25 `pseq` klCons (Types.Atom (Types.UnboundSym "shen.r")) appl_25
                                                                                                                                                                                                                        !appl_27 <- appl_24 `pseq` (appl_26 `pseq` klCons appl_24 appl_26)
                                                                                                                                                                                                                        !appl_28 <- kl_V2407 `pseq` (appl_27 `pseq` klCons kl_V2407 appl_27)
                                                                                                                                                                                                                        appl_28 `pseq` klCons (ApplC (wrapNamed "shen.app" kl_shen_app)) appl_28) (do !kl_if_29 <- kl_V2408 `pseq` kl_shen_PlusstringP kl_V2408
                                                                                                                                                                                                                                                                                                      !kl_if_30 <- klIf kl_if_29 (do !appl_31 <- kl_V2408 `pseq` pos kl_V2408 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                                                                                                                                                                                                                                     !kl_if_32 <- appl_31 `pseq` eq (Types.Atom (Types.Str "~")) appl_31
                                                                                                                                                                                                                                                                                                                                     klIf kl_if_32 (do !appl_33 <- kl_V2408 `pseq` tlstr kl_V2408
                                                                                                                                                                                                                                                                                                                                                       !kl_if_34 <- appl_33 `pseq` kl_shen_PlusstringP appl_33
                                                                                                                                                                                                                                                                                                                                                       klIf kl_if_34 (do !appl_35 <- kl_V2408 `pseq` tlstr kl_V2408
                                                                                                                                                                                                                                                                                                                                                                         !appl_36 <- appl_35 `pseq` pos appl_35 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                                                                                                                                                                                                                                                                         appl_36 `pseq` eq (Types.Atom (Types.Str "S")) appl_36) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))
                                                                                                                                                                                                                                                                                                      klIf kl_if_30 (do !appl_37 <- kl_V2408 `pseq` tlstr kl_V2408
                                                                                                                                                                                                                                                                                                                        !appl_38 <- appl_37 `pseq` tlstr appl_37
                                                                                                                                                                                                                                                                                                                        let !appl_39 = List []
                                                                                                                                                                                                                                                                                                                        !appl_40 <- appl_39 `pseq` klCons (Types.Atom (Types.UnboundSym "shen.s")) appl_39
                                                                                                                                                                                                                                                                                                                        !appl_41 <- appl_38 `pseq` (appl_40 `pseq` klCons appl_38 appl_40)
                                                                                                                                                                                                                                                                                                                        !appl_42 <- kl_V2407 `pseq` (appl_41 `pseq` klCons kl_V2407 appl_41)
                                                                                                                                                                                                                                                                                                                        appl_42 `pseq` klCons (ApplC (wrapNamed "shen.app" kl_shen_app)) appl_42) (do !kl_if_43 <- kl_V2408 `pseq` kl_shen_PlusstringP kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                      klIf kl_if_43 (do !appl_44 <- kl_V2408 `pseq` pos kl_V2408 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                                                                                                                                                                                                                                                                                                                        !appl_45 <- kl_V2408 `pseq` tlstr kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                        !appl_46 <- kl_V2407 `pseq` (appl_45 `pseq` kl_shen_insert_l kl_V2407 appl_45)
                                                                                                                                                                                                                                                                                                                                                                                                                        let !appl_47 = List []
                                                                                                                                                                                                                                                                                                                                                                                                                        !appl_48 <- appl_46 `pseq` (appl_47 `pseq` klCons appl_46 appl_47)
                                                                                                                                                                                                                                                                                                                                                                                                                        !appl_49 <- appl_44 `pseq` (appl_48 `pseq` klCons appl_44 appl_48)
                                                                                                                                                                                                                                                                                                                                                                                                                        !appl_50 <- appl_49 `pseq` klCons (ApplC (wrapNamed "cn" cn)) appl_49
                                                                                                                                                                                                                                                                                                                                                                                                                        appl_50 `pseq` kl_shen_factor_cn appl_50) (do !kl_if_51 <- kl_V2408 `pseq` consP kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      !kl_if_52 <- klIf kl_if_51 (do !appl_53 <- kl_V2408 `pseq` hd kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     !kl_if_54 <- appl_53 `pseq` eq (ApplC (wrapNamed "cn" cn)) appl_53
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     klIf kl_if_54 (do !appl_55 <- kl_V2408 `pseq` tl kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       !kl_if_56 <- appl_55 `pseq` consP appl_55
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       klIf kl_if_56 (do !appl_57 <- kl_V2408 `pseq` tl kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         !appl_58 <- appl_57 `pseq` tl appl_57
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         !kl_if_59 <- appl_58 `pseq` consP appl_58
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         klIf kl_if_59 (do let !appl_60 = List []
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           !appl_61 <- kl_V2408 `pseq` tl kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           !appl_62 <- appl_61 `pseq` tl appl_61
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           !appl_63 <- appl_62 `pseq` tl appl_62
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           appl_60 `pseq` (appl_63 `pseq` eq appl_60 appl_63)) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      klIf kl_if_52 (do !appl_64 <- kl_V2408 `pseq` tl kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        !appl_65 <- appl_64 `pseq` hd appl_64
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        !appl_66 <- kl_V2408 `pseq` tl kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        !appl_67 <- appl_66 `pseq` tl appl_66
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        !appl_68 <- appl_67 `pseq` hd appl_67
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        !appl_69 <- kl_V2407 `pseq` (appl_68 `pseq` kl_shen_insert_l kl_V2407 appl_68)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        let !appl_70 = List []
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        !appl_71 <- appl_69 `pseq` (appl_70 `pseq` klCons appl_69 appl_70)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        !appl_72 <- appl_65 `pseq` (appl_71 `pseq` klCons appl_65 appl_71)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        appl_72 `pseq` klCons (ApplC (wrapNamed "cn" cn)) appl_72) (do !kl_if_73 <- kl_V2408 `pseq` consP kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       !kl_if_74 <- klIf kl_if_73 (do !appl_75 <- kl_V2408 `pseq` hd kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      !kl_if_76 <- appl_75 `pseq` eq (ApplC (wrapNamed "shen.app" kl_shen_app)) appl_75
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      klIf kl_if_76 (do !appl_77 <- kl_V2408 `pseq` tl kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        !kl_if_78 <- appl_77 `pseq` consP appl_77
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        klIf kl_if_78 (do !appl_79 <- kl_V2408 `pseq` tl kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          !appl_80 <- appl_79 `pseq` tl appl_79
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          !kl_if_81 <- appl_80 `pseq` consP appl_80
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          klIf kl_if_81 (do !appl_82 <- kl_V2408 `pseq` tl kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            !appl_83 <- appl_82 `pseq` tl appl_82
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            !appl_84 <- appl_83 `pseq` tl appl_83
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            !kl_if_85 <- appl_84 `pseq` consP appl_84
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            klIf kl_if_85 (do let !appl_86 = List []
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              !appl_87 <- kl_V2408 `pseq` tl kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              !appl_88 <- appl_87 `pseq` tl appl_87
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              !appl_89 <- appl_88 `pseq` tl appl_88
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              !appl_90 <- appl_89 `pseq` tl appl_89
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              appl_86 `pseq` (appl_90 `pseq` eq appl_86 appl_90)) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       klIf kl_if_74 (do !appl_91 <- kl_V2408 `pseq` tl kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         !appl_92 <- appl_91 `pseq` hd appl_91
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         !appl_93 <- kl_V2408 `pseq` tl kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         !appl_94 <- appl_93 `pseq` tl appl_93
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         !appl_95 <- appl_94 `pseq` hd appl_94
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         !appl_96 <- kl_V2407 `pseq` (appl_95 `pseq` kl_shen_insert_l kl_V2407 appl_95)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         !appl_97 <- kl_V2408 `pseq` tl kl_V2408
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         !appl_98 <- appl_97 `pseq` tl appl_97
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         !appl_99 <- appl_98 `pseq` tl appl_98
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         !appl_100 <- appl_96 `pseq` (appl_99 `pseq` klCons appl_96 appl_99)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         !appl_101 <- appl_92 `pseq` (appl_100 `pseq` klCons appl_92 appl_100)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         appl_101 `pseq` klCons (ApplC (wrapNamed "shen.app" kl_shen_app)) appl_101) (do klIf (Atom (B True)) (do kl_shen_f_error (ApplC (wrapNamed "shen.insert-l" kl_shen_insert_l))) (do return (List [])))))))))

kl_shen_factor_cn :: Types.KLValue ->
                     Types.KLContext Types.Env Types.KLValue
kl_shen_factor_cn (!kl_V2409) = do !kl_if_0 <- kl_V2409 `pseq` consP kl_V2409
                                   !kl_if_1 <- klIf kl_if_0 (do !appl_2 <- kl_V2409 `pseq` hd kl_V2409
                                                                !kl_if_3 <- appl_2 `pseq` eq (ApplC (wrapNamed "cn" cn)) appl_2
                                                                klIf kl_if_3 (do !appl_4 <- kl_V2409 `pseq` tl kl_V2409
                                                                                 !kl_if_5 <- appl_4 `pseq` consP appl_4
                                                                                 klIf kl_if_5 (do !appl_6 <- kl_V2409 `pseq` tl kl_V2409
                                                                                                  !appl_7 <- appl_6 `pseq` tl appl_6
                                                                                                  !kl_if_8 <- appl_7 `pseq` consP appl_7
                                                                                                  klIf kl_if_8 (do !appl_9 <- kl_V2409 `pseq` tl kl_V2409
                                                                                                                   !appl_10 <- appl_9 `pseq` tl appl_9
                                                                                                                   !appl_11 <- appl_10 `pseq` hd appl_10
                                                                                                                   !kl_if_12 <- appl_11 `pseq` consP appl_11
                                                                                                                   klIf kl_if_12 (do !appl_13 <- kl_V2409 `pseq` tl kl_V2409
                                                                                                                                     !appl_14 <- appl_13 `pseq` tl appl_13
                                                                                                                                     !appl_15 <- appl_14 `pseq` hd appl_14
                                                                                                                                     !appl_16 <- appl_15 `pseq` hd appl_15
                                                                                                                                     !kl_if_17 <- appl_16 `pseq` eq (ApplC (wrapNamed "cn" cn)) appl_16
                                                                                                                                     klIf kl_if_17 (do !appl_18 <- kl_V2409 `pseq` tl kl_V2409
                                                                                                                                                       !appl_19 <- appl_18 `pseq` tl appl_18
                                                                                                                                                       !appl_20 <- appl_19 `pseq` hd appl_19
                                                                                                                                                       !appl_21 <- appl_20 `pseq` tl appl_20
                                                                                                                                                       !kl_if_22 <- appl_21 `pseq` consP appl_21
                                                                                                                                                       klIf kl_if_22 (do !appl_23 <- kl_V2409 `pseq` tl kl_V2409
                                                                                                                                                                         !appl_24 <- appl_23 `pseq` tl appl_23
                                                                                                                                                                         !appl_25 <- appl_24 `pseq` hd appl_24
                                                                                                                                                                         !appl_26 <- appl_25 `pseq` tl appl_25
                                                                                                                                                                         !appl_27 <- appl_26 `pseq` tl appl_26
                                                                                                                                                                         !kl_if_28 <- appl_27 `pseq` consP appl_27
                                                                                                                                                                         klIf kl_if_28 (do let !appl_29 = List []
                                                                                                                                                                                           !appl_30 <- kl_V2409 `pseq` tl kl_V2409
                                                                                                                                                                                           !appl_31 <- appl_30 `pseq` tl appl_30
                                                                                                                                                                                           !appl_32 <- appl_31 `pseq` hd appl_31
                                                                                                                                                                                           !appl_33 <- appl_32 `pseq` tl appl_32
                                                                                                                                                                                           !appl_34 <- appl_33 `pseq` tl appl_33
                                                                                                                                                                                           !appl_35 <- appl_34 `pseq` tl appl_34
                                                                                                                                                                                           !kl_if_36 <- appl_29 `pseq` (appl_35 `pseq` eq appl_29 appl_35)
                                                                                                                                                                                           klIf kl_if_36 (do let !appl_37 = List []
                                                                                                                                                                                                             !appl_38 <- kl_V2409 `pseq` tl kl_V2409
                                                                                                                                                                                                             !appl_39 <- appl_38 `pseq` tl appl_38
                                                                                                                                                                                                             !appl_40 <- appl_39 `pseq` tl appl_39
                                                                                                                                                                                                             !kl_if_41 <- appl_37 `pseq` (appl_40 `pseq` eq appl_37 appl_40)
                                                                                                                                                                                                             klIf kl_if_41 (do !appl_42 <- kl_V2409 `pseq` tl kl_V2409
                                                                                                                                                                                                                               !appl_43 <- appl_42 `pseq` hd appl_42
                                                                                                                                                                                                                               !kl_if_44 <- appl_43 `pseq` stringP appl_43
                                                                                                                                                                                                                               klIf kl_if_44 (do !appl_45 <- kl_V2409 `pseq` tl kl_V2409
                                                                                                                                                                                                                                                 !appl_46 <- appl_45 `pseq` tl appl_45
                                                                                                                                                                                                                                                 !appl_47 <- appl_46 `pseq` hd appl_46
                                                                                                                                                                                                                                                 !appl_48 <- appl_47 `pseq` tl appl_47
                                                                                                                                                                                                                                                 !appl_49 <- appl_48 `pseq` hd appl_48
                                                                                                                                                                                                                                                 appl_49 `pseq` stringP appl_49) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))
                                   klIf kl_if_1 (do !appl_50 <- kl_V2409 `pseq` tl kl_V2409
                                                    !appl_51 <- appl_50 `pseq` hd appl_50
                                                    !appl_52 <- kl_V2409 `pseq` tl kl_V2409
                                                    !appl_53 <- appl_52 `pseq` tl appl_52
                                                    !appl_54 <- appl_53 `pseq` hd appl_53
                                                    !appl_55 <- appl_54 `pseq` tl appl_54
                                                    !appl_56 <- appl_55 `pseq` hd appl_55
                                                    !appl_57 <- appl_51 `pseq` (appl_56 `pseq` cn appl_51 appl_56)
                                                    !appl_58 <- kl_V2409 `pseq` tl kl_V2409
                                                    !appl_59 <- appl_58 `pseq` tl appl_58
                                                    !appl_60 <- appl_59 `pseq` hd appl_59
                                                    !appl_61 <- appl_60 `pseq` tl appl_60
                                                    !appl_62 <- appl_61 `pseq` tl appl_61
                                                    !appl_63 <- appl_57 `pseq` (appl_62 `pseq` klCons appl_57 appl_62)
                                                    appl_63 `pseq` klCons (ApplC (wrapNamed "cn" cn)) appl_63) (do klIf (Atom (B True)) (do return kl_V2409) (do return (List [])))

kl_shen_proc_nl :: Types.KLValue ->
                   Types.KLContext Types.Env Types.KLValue
kl_shen_proc_nl (!kl_V2410) = do !kl_if_0 <- kl_V2410 `pseq` eq (Types.Atom (Types.Str "")) kl_V2410
                                 klIf kl_if_0 (do return (Types.Atom (Types.Str ""))) (do !kl_if_1 <- kl_V2410 `pseq` kl_shen_PlusstringP kl_V2410
                                                                                          !kl_if_2 <- klIf kl_if_1 (do !appl_3 <- kl_V2410 `pseq` pos kl_V2410 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                       !kl_if_4 <- appl_3 `pseq` eq (Types.Atom (Types.Str "~")) appl_3
                                                                                                                       klIf kl_if_4 (do !appl_5 <- kl_V2410 `pseq` tlstr kl_V2410
                                                                                                                                        !kl_if_6 <- appl_5 `pseq` kl_shen_PlusstringP appl_5
                                                                                                                                        klIf kl_if_6 (do !appl_7 <- kl_V2410 `pseq` tlstr kl_V2410
                                                                                                                                                         !appl_8 <- appl_7 `pseq` pos appl_7 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                                                         appl_8 `pseq` eq (Types.Atom (Types.Str "%")) appl_8) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))
                                                                                          klIf kl_if_2 (do !appl_9 <- nToString (Types.Atom (Types.N (Types.KI 10)))
                                                                                                           !appl_10 <- kl_V2410 `pseq` tlstr kl_V2410
                                                                                                           !appl_11 <- appl_10 `pseq` tlstr appl_10
                                                                                                           !appl_12 <- appl_11 `pseq` kl_shen_proc_nl appl_11
                                                                                                           appl_9 `pseq` (appl_12 `pseq` cn appl_9 appl_12)) (do !kl_if_13 <- kl_V2410 `pseq` kl_shen_PlusstringP kl_V2410
                                                                                                                                                                 klIf kl_if_13 (do !appl_14 <- kl_V2410 `pseq` pos kl_V2410 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                                                                                   !appl_15 <- kl_V2410 `pseq` tlstr kl_V2410
                                                                                                                                                                                   !appl_16 <- appl_15 `pseq` kl_shen_proc_nl appl_15
                                                                                                                                                                                   appl_14 `pseq` (appl_16 `pseq` cn appl_14 appl_16)) (do klIf (Atom (B True)) (do kl_shen_f_error (ApplC (wrapNamed "shen.proc-nl" kl_shen_proc_nl))) (do return (List [])))))

kl_shen_mkstr_r :: Types.KLValue ->
                   Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_shen_mkstr_r (!kl_V2411) (!kl_V2412) = do let !appl_0 = List []
                                             !kl_if_1 <- appl_0 `pseq` (kl_V2412 `pseq` eq appl_0 kl_V2412)
                                             klIf kl_if_1 (do return kl_V2411) (do !kl_if_2 <- kl_V2412 `pseq` consP kl_V2412
                                                                                   klIf kl_if_2 (do !appl_3 <- kl_V2412 `pseq` hd kl_V2412
                                                                                                    let !appl_4 = List []
                                                                                                    !appl_5 <- kl_V2411 `pseq` (appl_4 `pseq` klCons kl_V2411 appl_4)
                                                                                                    !appl_6 <- appl_3 `pseq` (appl_5 `pseq` klCons appl_3 appl_5)
                                                                                                    !appl_7 <- appl_6 `pseq` klCons (ApplC (wrapNamed "shen.insert" kl_shen_insert)) appl_6
                                                                                                    !appl_8 <- kl_V2412 `pseq` tl kl_V2412
                                                                                                    appl_7 `pseq` (appl_8 `pseq` kl_shen_mkstr_r appl_7 appl_8)) (do klIf (Atom (B True)) (do kl_shen_f_error (ApplC (wrapNamed "shen.mkstr-r" kl_shen_mkstr_r))) (do return (List []))))

kl_shen_insert :: Types.KLValue ->
                  Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_shen_insert (!kl_V2413) (!kl_V2414) = do kl_V2413 `pseq` (kl_V2414 `pseq` kl_shen_insert_h kl_V2413 kl_V2414 (Types.Atom (Types.Str "")))

kl_shen_insert_h :: Types.KLValue ->
                    Types.KLValue ->
                    Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_shen_insert_h (!kl_V2417) (!kl_V2418) (!kl_V2419) = do !kl_if_0 <- kl_V2418 `pseq` eq (Types.Atom (Types.Str "")) kl_V2418
                                                          klIf kl_if_0 (do return kl_V2419) (do !kl_if_1 <- kl_V2418 `pseq` kl_shen_PlusstringP kl_V2418
                                                                                                !kl_if_2 <- klIf kl_if_1 (do !appl_3 <- kl_V2418 `pseq` pos kl_V2418 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                             !kl_if_4 <- appl_3 `pseq` eq (Types.Atom (Types.Str "~")) appl_3
                                                                                                                             klIf kl_if_4 (do !appl_5 <- kl_V2418 `pseq` tlstr kl_V2418
                                                                                                                                              !kl_if_6 <- appl_5 `pseq` kl_shen_PlusstringP appl_5
                                                                                                                                              klIf kl_if_6 (do !appl_7 <- kl_V2418 `pseq` tlstr kl_V2418
                                                                                                                                                               !appl_8 <- appl_7 `pseq` pos appl_7 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                                                               appl_8 `pseq` eq (Types.Atom (Types.Str "A")) appl_8) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))
                                                                                                klIf kl_if_2 (do !appl_9 <- kl_V2418 `pseq` tlstr kl_V2418
                                                                                                                 !appl_10 <- appl_9 `pseq` tlstr appl_9
                                                                                                                 !appl_11 <- kl_V2417 `pseq` (appl_10 `pseq` kl_shen_app kl_V2417 appl_10 (Types.Atom (Types.UnboundSym "shen.a")))
                                                                                                                 kl_V2419 `pseq` (appl_11 `pseq` cn kl_V2419 appl_11)) (do !kl_if_12 <- kl_V2418 `pseq` kl_shen_PlusstringP kl_V2418
                                                                                                                                                                           !kl_if_13 <- klIf kl_if_12 (do !appl_14 <- kl_V2418 `pseq` pos kl_V2418 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                                                                                                          !kl_if_15 <- appl_14 `pseq` eq (Types.Atom (Types.Str "~")) appl_14
                                                                                                                                                                                                          klIf kl_if_15 (do !appl_16 <- kl_V2418 `pseq` tlstr kl_V2418
                                                                                                                                                                                                                            !kl_if_17 <- appl_16 `pseq` kl_shen_PlusstringP appl_16
                                                                                                                                                                                                                            klIf kl_if_17 (do !appl_18 <- kl_V2418 `pseq` tlstr kl_V2418
                                                                                                                                                                                                                                              !appl_19 <- appl_18 `pseq` pos appl_18 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                                                                                                                                              appl_19 `pseq` eq (Types.Atom (Types.Str "R")) appl_19) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))
                                                                                                                                                                           klIf kl_if_13 (do !appl_20 <- kl_V2418 `pseq` tlstr kl_V2418
                                                                                                                                                                                             !appl_21 <- appl_20 `pseq` tlstr appl_20
                                                                                                                                                                                             !appl_22 <- kl_V2417 `pseq` (appl_21 `pseq` kl_shen_app kl_V2417 appl_21 (Types.Atom (Types.UnboundSym "shen.r")))
                                                                                                                                                                                             kl_V2419 `pseq` (appl_22 `pseq` cn kl_V2419 appl_22)) (do !kl_if_23 <- kl_V2418 `pseq` kl_shen_PlusstringP kl_V2418
                                                                                                                                                                                                                                                       !kl_if_24 <- klIf kl_if_23 (do !appl_25 <- kl_V2418 `pseq` pos kl_V2418 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                                                                                                                                                                                      !kl_if_26 <- appl_25 `pseq` eq (Types.Atom (Types.Str "~")) appl_25
                                                                                                                                                                                                                                                                                      klIf kl_if_26 (do !appl_27 <- kl_V2418 `pseq` tlstr kl_V2418
                                                                                                                                                                                                                                                                                                        !kl_if_28 <- appl_27 `pseq` kl_shen_PlusstringP appl_27
                                                                                                                                                                                                                                                                                                        klIf kl_if_28 (do !appl_29 <- kl_V2418 `pseq` tlstr kl_V2418
                                                                                                                                                                                                                                                                                                                          !appl_30 <- appl_29 `pseq` pos appl_29 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                                                                                                                                                                                                                          appl_30 `pseq` eq (Types.Atom (Types.Str "S")) appl_30) (do return (Atom (B False)))) (do return (Atom (B False)))) (do return (Atom (B False)))
                                                                                                                                                                                                                                                       klIf kl_if_24 (do !appl_31 <- kl_V2418 `pseq` tlstr kl_V2418
                                                                                                                                                                                                                                                                         !appl_32 <- appl_31 `pseq` tlstr appl_31
                                                                                                                                                                                                                                                                         !appl_33 <- kl_V2417 `pseq` (appl_32 `pseq` kl_shen_app kl_V2417 appl_32 (Types.Atom (Types.UnboundSym "shen.s")))
                                                                                                                                                                                                                                                                         kl_V2419 `pseq` (appl_33 `pseq` cn kl_V2419 appl_33)) (do !kl_if_34 <- kl_V2418 `pseq` kl_shen_PlusstringP kl_V2418
                                                                                                                                                                                                                                                                                                                                   klIf kl_if_34 (do !appl_35 <- kl_V2418 `pseq` tlstr kl_V2418
                                                                                                                                                                                                                                                                                                                                                     !appl_36 <- kl_V2418 `pseq` pos kl_V2418 (Types.Atom (Types.N (Types.KI 0)))
                                                                                                                                                                                                                                                                                                                                                     !appl_37 <- kl_V2419 `pseq` (appl_36 `pseq` cn kl_V2419 appl_36)
                                                                                                                                                                                                                                                                                                                                                     kl_V2417 `pseq` (appl_35 `pseq` (appl_37 `pseq` kl_shen_insert_h kl_V2417 appl_35 appl_37))) (do klIf (Atom (B True)) (do kl_shen_f_error (ApplC (wrapNamed "shen.insert-h" kl_shen_insert_h))) (do return (List [])))))))

kl_shen_app :: Types.KLValue ->
               Types.KLValue ->
               Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_shen_app (!kl_V2420) (!kl_V2421) (!kl_V2422) = do !appl_0 <- kl_V2420 `pseq` (kl_V2422 `pseq` kl_shen_arg_RBstr kl_V2420 kl_V2422)
                                                     appl_0 `pseq` (kl_V2421 `pseq` cn appl_0 kl_V2421)

kl_shen_arg_RBstr :: Types.KLValue ->
                     Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_shen_arg_RBstr (!kl_V2428) (!kl_V2429) = do !appl_0 <- kl_fail
                                               !kl_if_1 <- kl_V2428 `pseq` (appl_0 `pseq` eq kl_V2428 appl_0)
                                               klIf kl_if_1 (do return (Types.Atom (Types.Str "..."))) (do !kl_if_2 <- kl_V2428 `pseq` kl_shen_listP kl_V2428
                                                                                                           klIf kl_if_2 (do kl_V2428 `pseq` (kl_V2429 `pseq` kl_shen_list_RBstr kl_V2428 kl_V2429)) (do !kl_if_3 <- kl_V2428 `pseq` stringP kl_V2428
                                                                                                                                                                                                        klIf kl_if_3 (do kl_V2428 `pseq` (kl_V2429 `pseq` kl_shen_str_RBstr kl_V2428 kl_V2429)) (do !kl_if_4 <- kl_V2428 `pseq` absvectorP kl_V2428
                                                                                                                                                                                                                                                                                                    klIf kl_if_4 (do kl_V2428 `pseq` (kl_V2429 `pseq` kl_shen_vector_RBstr kl_V2428 kl_V2429)) (do klIf (Atom (B True)) (do kl_V2428 `pseq` kl_shen_atom_RBstr kl_V2428) (do return (List []))))))

kl_shen_list_RBstr :: Types.KLValue ->
                      Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_shen_list_RBstr (!kl_V2430) (!kl_V2431) = do !kl_if_0 <- kl_V2431 `pseq` eq (Types.Atom (Types.UnboundSym "shen.r")) kl_V2431
                                                klIf kl_if_0 (do !appl_1 <- kl_shen_maxseq
                                                                 !appl_2 <- kl_V2430 `pseq` (appl_1 `pseq` kl_shen_iter_list kl_V2430 (Types.Atom (Types.UnboundSym "shen.r")) appl_1)
                                                                 !appl_3 <- appl_2 `pseq` kl_Ats appl_2 (Types.Atom (Types.Str ")"))
                                                                 appl_3 `pseq` kl_Ats (Types.Atom (Types.Str "(")) appl_3) (do klIf (Atom (B True)) (do !appl_4 <- kl_shen_maxseq
                                                                                                                                                        !appl_5 <- kl_V2430 `pseq` (kl_V2431 `pseq` (appl_4 `pseq` kl_shen_iter_list kl_V2430 kl_V2431 appl_4))
                                                                                                                                                        !appl_6 <- appl_5 `pseq` kl_Ats appl_5 (Types.Atom (Types.Str "]"))
                                                                                                                                                        appl_6 `pseq` kl_Ats (Types.Atom (Types.Str "[")) appl_6) (do return (List [])))

kl_shen_maxseq :: Types.KLContext Types.Env Types.KLValue
kl_shen_maxseq = do value (Types.Atom (Types.UnboundSym "*maximum-print-sequence-size*"))

kl_shen_iter_list :: Types.KLValue ->
                     Types.KLValue ->
                     Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_shen_iter_list (!kl_V2442) (!kl_V2443) (!kl_V2444) = do let !appl_0 = List []
                                                           !kl_if_1 <- appl_0 `pseq` (kl_V2442 `pseq` eq appl_0 kl_V2442)
                                                           klIf kl_if_1 (do return (Types.Atom (Types.Str ""))) (do !kl_if_2 <- kl_V2444 `pseq` eq (Types.Atom (Types.N (Types.KI 0))) kl_V2444
                                                                                                                    klIf kl_if_2 (do return (Types.Atom (Types.Str "... etc"))) (do !kl_if_3 <- kl_V2442 `pseq` consP kl_V2442
                                                                                                                                                                                    !kl_if_4 <- klIf kl_if_3 (do let !appl_5 = List []
                                                                                                                                                                                                                 !appl_6 <- kl_V2442 `pseq` tl kl_V2442
                                                                                                                                                                                                                 appl_5 `pseq` (appl_6 `pseq` eq appl_5 appl_6)) (do return (Atom (B False)))
                                                                                                                                                                                    klIf kl_if_4 (do !appl_7 <- kl_V2442 `pseq` hd kl_V2442
                                                                                                                                                                                                     appl_7 `pseq` (kl_V2443 `pseq` kl_shen_arg_RBstr appl_7 kl_V2443)) (do !kl_if_8 <- kl_V2442 `pseq` consP kl_V2442
                                                                                                                                                                                                                                                                            klIf kl_if_8 (do !appl_9 <- kl_V2442 `pseq` hd kl_V2442
                                                                                                                                                                                                                                                                                             !appl_10 <- appl_9 `pseq` (kl_V2443 `pseq` kl_shen_arg_RBstr appl_9 kl_V2443)
                                                                                                                                                                                                                                                                                             !appl_11 <- kl_V2442 `pseq` tl kl_V2442
                                                                                                                                                                                                                                                                                             !appl_12 <- kl_V2444 `pseq` Primitives.subtract kl_V2444 (Types.Atom (Types.N (Types.KI 1)))
                                                                                                                                                                                                                                                                                             !appl_13 <- appl_11 `pseq` (kl_V2443 `pseq` (appl_12 `pseq` kl_shen_iter_list appl_11 kl_V2443 appl_12))
                                                                                                                                                                                                                                                                                             !appl_14 <- appl_13 `pseq` kl_Ats (Types.Atom (Types.Str " ")) appl_13
                                                                                                                                                                                                                                                                                             appl_10 `pseq` (appl_14 `pseq` kl_Ats appl_10 appl_14)) (do klIf (Atom (B True)) (do !appl_15 <- kl_V2442 `pseq` (kl_V2443 `pseq` kl_shen_arg_RBstr kl_V2442 kl_V2443)
                                                                                                                                                                                                                                                                                                                                                                                  !appl_16 <- appl_15 `pseq` kl_Ats (Types.Atom (Types.Str " ")) appl_15
                                                                                                                                                                                                                                                                                                                                                                                  appl_16 `pseq` kl_Ats (Types.Atom (Types.Str "|")) appl_16) (do return (List []))))))

kl_shen_str_RBstr :: Types.KLValue ->
                     Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_shen_str_RBstr (!kl_V2449) (!kl_V2450) = do !kl_if_0 <- kl_V2450 `pseq` eq (Types.Atom (Types.UnboundSym "shen.a")) kl_V2450
                                               klIf kl_if_0 (do return kl_V2449) (do klIf (Atom (B True)) (do !appl_1 <- nToString (Types.Atom (Types.N (Types.KI 34)))
                                                                                                              !appl_2 <- nToString (Types.Atom (Types.N (Types.KI 34)))
                                                                                                              !appl_3 <- kl_V2449 `pseq` (appl_2 `pseq` kl_Ats kl_V2449 appl_2)
                                                                                                              appl_1 `pseq` (appl_3 `pseq` kl_Ats appl_1 appl_3)) (do return (List [])))

kl_shen_vector_RBstr :: Types.KLValue ->
                        Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_shen_vector_RBstr (!kl_V2451) (!kl_V2452) = do !kl_if_0 <- kl_V2451 `pseq` kl_shen_print_vectorP kl_V2451
                                                  klIf kl_if_0 (do !appl_1 <- kl_V2451 `pseq` addressFrom kl_V2451 (Types.Atom (Types.N (Types.KI 0)))
                                                                   kl_V2451 `pseq` applyWrapper appl_1 [kl_V2451]) (do !kl_if_2 <- kl_V2451 `pseq` kl_vectorP kl_V2451
                                                                                                                       klIf kl_if_2 (do !appl_3 <- kl_shen_maxseq
                                                                                                                                        !appl_4 <- kl_V2451 `pseq` (kl_V2452 `pseq` (appl_3 `pseq` kl_shen_iter_vector kl_V2451 (Types.Atom (Types.N (Types.KI 1))) kl_V2452 appl_3))
                                                                                                                                        !appl_5 <- appl_4 `pseq` kl_Ats appl_4 (Types.Atom (Types.Str ">"))
                                                                                                                                        appl_5 `pseq` kl_Ats (Types.Atom (Types.Str "<")) appl_5) (do !appl_6 <- kl_shen_maxseq
                                                                                                                                                                                                      !appl_7 <- kl_V2451 `pseq` (kl_V2452 `pseq` (appl_6 `pseq` kl_shen_iter_vector kl_V2451 (Types.Atom (Types.N (Types.KI 0))) kl_V2452 appl_6))
                                                                                                                                                                                                      !appl_8 <- appl_7 `pseq` kl_Ats appl_7 (Types.Atom (Types.Str ">>"))
                                                                                                                                                                                                      !appl_9 <- appl_8 `pseq` kl_Ats (Types.Atom (Types.Str "<")) appl_8
                                                                                                                                                                                                      appl_9 `pseq` kl_Ats (Types.Atom (Types.Str "<")) appl_9))

kl_shen_print_vectorP :: Types.KLValue ->
                         Types.KLContext Types.Env Types.KLValue
kl_shen_print_vectorP (!kl_V2453) = do let !appl_0 = ApplC (Func "lambda" (Context (\(!kl_Zero) -> do !kl_if_1 <- kl_Zero `pseq` eq kl_Zero (ApplC (wrapNamed "shen.tuple" kl_shen_tuple))
                                                                                                      klIf kl_if_1 (do return (Atom (B True))) (do !kl_if_2 <- kl_Zero `pseq` eq kl_Zero (ApplC (wrapNamed "shen.pvar" kl_shen_pvar))
                                                                                                                                                   klIf kl_if_2 (do return (Atom (B True))) (do !appl_3 <- kl_Zero `pseq` numberP kl_Zero
                                                                                                                                                                                                !kl_if_4 <- appl_3 `pseq` kl_not appl_3
                                                                                                                                                                                                klIf kl_if_4 (do kl_Zero `pseq` kl_shen_fboundP kl_Zero) (do return (Atom (B False))))))))
                                       !appl_5 <- kl_V2453 `pseq` addressFrom kl_V2453 (Types.Atom (Types.N (Types.KI 0)))
                                       appl_5 `pseq` applyWrapper appl_0 [appl_5]

kl_shen_fboundP :: Types.KLValue ->
                   Types.KLContext Types.Env Types.KLValue
kl_shen_fboundP (!kl_V2454) = do (do !appl_0 <- kl_V2454 `pseq` kl_ps kl_V2454
                                     appl_0 `pseq` kl_do appl_0 (Atom (B True))) `catchError` (\(!kl_E) -> do return (Atom (B False)))

kl_shen_tuple :: Types.KLValue ->
                 Types.KLContext Types.Env Types.KLValue
kl_shen_tuple (!kl_V2455) = do !appl_0 <- kl_V2455 `pseq` addressFrom kl_V2455 (Types.Atom (Types.N (Types.KI 1)))
                               !appl_1 <- kl_V2455 `pseq` addressFrom kl_V2455 (Types.Atom (Types.N (Types.KI 2)))
                               !appl_2 <- appl_1 `pseq` kl_shen_app appl_1 (Types.Atom (Types.Str ")")) (Types.Atom (Types.UnboundSym "shen.s"))
                               !appl_3 <- appl_2 `pseq` cn (Types.Atom (Types.Str " ")) appl_2
                               !appl_4 <- appl_0 `pseq` (appl_3 `pseq` kl_shen_app appl_0 appl_3 (Types.Atom (Types.UnboundSym "shen.s")))
                               appl_4 `pseq` cn (Types.Atom (Types.Str "(@p ")) appl_4

kl_shen_iter_vector :: Types.KLValue ->
                       Types.KLValue ->
                       Types.KLValue ->
                       Types.KLValue -> Types.KLContext Types.Env Types.KLValue
kl_shen_iter_vector (!kl_V2462) (!kl_V2463) (!kl_V2464) (!kl_V2465) = do !kl_if_0 <- kl_V2465 `pseq` eq (Types.Atom (Types.N (Types.KI 0))) kl_V2465
                                                                         klIf kl_if_0 (do return (Types.Atom (Types.Str "... etc"))) (do klIf (Atom (B True)) (do let !appl_1 = ApplC (Func "lambda" (Context (\(!kl_Item) -> do let !appl_2 = ApplC (Func "lambda" (Context (\(!kl_Next) -> do !kl_if_3 <- kl_Item `pseq` eq kl_Item (Types.Atom (Types.UnboundSym "shen.out-of-bounds"))
                                                                                                                                                                                                                                                                                                klIf kl_if_3 (do return (Types.Atom (Types.Str ""))) (do !kl_if_4 <- kl_Next `pseq` eq kl_Next (Types.Atom (Types.UnboundSym "shen.out-of-bounds"))
                                                                                                                                                                                                                                                                                                                                                         klIf kl_if_4 (do kl_Item `pseq` (kl_V2464 `pseq` kl_shen_arg_RBstr kl_Item kl_V2464)) (do !appl_5 <- kl_Item `pseq` (kl_V2464 `pseq` kl_shen_arg_RBstr kl_Item kl_V2464)
                                                                                                                                                                                                                                                                                                                                                                                                                                                   !appl_6 <- kl_V2463 `pseq` add kl_V2463 (Types.Atom (Types.N (Types.KI 1)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                   !appl_7 <- kl_V2465 `pseq` Primitives.subtract kl_V2465 (Types.Atom (Types.N (Types.KI 1)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                   !appl_8 <- kl_V2462 `pseq` (appl_6 `pseq` (kl_V2464 `pseq` (appl_7 `pseq` kl_shen_iter_vector kl_V2462 appl_6 kl_V2464 appl_7)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                   !appl_9 <- appl_8 `pseq` kl_Ats (Types.Atom (Types.Str " ")) appl_8
                                                                                                                                                                                                                                                                                                                                                                                                                                                   appl_5 `pseq` (appl_9 `pseq` kl_Ats appl_5 appl_9))))))
                                                                                                                                                                                                                                 !appl_10 <- (do !appl_11 <- kl_V2463 `pseq` add kl_V2463 (Types.Atom (Types.N (Types.KI 1)))
                                                                                                                                                                                                                                                 kl_V2462 `pseq` (appl_11 `pseq` addressFrom kl_V2462 appl_11)) `catchError` (\(!kl_E) -> do return (Types.Atom (Types.UnboundSym "shen.out-of-bounds")))
                                                                                                                                                                                                                                 appl_10 `pseq` applyWrapper appl_2 [appl_10])))
                                                                                                                                                                  !appl_12 <- (do kl_V2462 `pseq` (kl_V2463 `pseq` addressFrom kl_V2462 kl_V2463)) `catchError` (\(!kl_E) -> do return (Types.Atom (Types.UnboundSym "shen.out-of-bounds")))
                                                                                                                                                                  appl_12 `pseq` applyWrapper appl_1 [appl_12]) (do return (List [])))

kl_shen_atom_RBstr :: Types.KLValue ->
                      Types.KLContext Types.Env Types.KLValue
kl_shen_atom_RBstr (!kl_V2466) = do (do kl_V2466 `pseq` str kl_V2466) `catchError` (\(!kl_E) -> do kl_shen_funexstring)

kl_shen_funexstring :: Types.KLContext Types.Env Types.KLValue
kl_shen_funexstring = do !appl_0 <- intern (Types.Atom (Types.Str "x"))
                         !appl_1 <- appl_0 `pseq` kl_gensym appl_0
                         !appl_2 <- appl_1 `pseq` kl_shen_arg_RBstr appl_1 (Types.Atom (Types.UnboundSym "shen.a"))
                         !appl_3 <- appl_2 `pseq` kl_Ats appl_2 (Types.Atom (Types.Str "\\DC1"))
                         !appl_4 <- appl_3 `pseq` kl_Ats (Types.Atom (Types.Str "e")) appl_3
                         !appl_5 <- appl_4 `pseq` kl_Ats (Types.Atom (Types.Str "n")) appl_4
                         !appl_6 <- appl_5 `pseq` kl_Ats (Types.Atom (Types.Str "u")) appl_5
                         !appl_7 <- appl_6 `pseq` kl_Ats (Types.Atom (Types.Str "f")) appl_6
                         appl_7 `pseq` kl_Ats (Types.Atom (Types.Str "\\DLE")) appl_7

kl_shen_listP :: Types.KLValue ->
                 Types.KLContext Types.Env Types.KLValue
kl_shen_listP (!kl_V2467) = do !kl_if_0 <- kl_V2467 `pseq` kl_emptyP kl_V2467
                               klIf kl_if_0 (do return (Atom (B True))) (do kl_V2467 `pseq` consP kl_V2467)

expr9 :: Types.KLContext Types.Env Types.KLValue
expr9 = do (return $ List [])
